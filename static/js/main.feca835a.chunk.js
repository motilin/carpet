(this.webpackJsonpcarpet=this.webpackJsonpcarpet||[]).push([[0],{264:function(t,e,n){},265:function(t,e,n){},271:function(t,e){},272:function(t,e){},280:function(t,e){},283:function(t,e){},284:function(t,e){},285:function(t,e){},287:function(t,e,n){"use strict";n.r(e);var c=n(40),r=n.n(c),a=n(237),i=n.n(a),o=(n(264),n(4)),s=(n(265),n(197)),u=n(47),f=n(37);function l(t){var e=t.canvasRef,n=t.props,r=function(){var t=e.current,n=u.d([400,400,3]);u.a.toPixels(n,t).then((function(){n.dispose()}))},a=function(){for(var t=Math.floor(2*Math.random()),n=0,c=0;400-n*c>10;)n=Math.floor(100*Math.random()+20),c=Math.floor(400/n);var r,a=[c,c],i=[n,n],o=e.current,s=u.h([[[1],[0]],[[0],[1]]]).asType("float32");r=t?u.b.resizeNearestNeighbor(s,i,!0):u.b.resizeBilinear(s,i,!0);var f,l=u.g(r);try{f=l.tile(a)}catch(d){return console.log(d),null}u.a.toPixels(f,o).then((function(){s.dispose(),r.dispose(),l.dispose(),f.dispose()}))};return Object(c.useEffect)((function(){a()}),[]),Object(f.jsx)("canvas",Object(s.a)(Object(s.a)({ref:e},n),{},{onClick:function(){Math.floor(2*Math.random())?r():a()}}))}var d=n.p+"static/media/hordus1.a95dd085.jpeg",j=n.p+"static/media/hordus2.7b3ff907.jpeg",h=n.p+"static/media/hordus3.5629ee33.jpeg";function b(t){var e=t.imgRef,n=Object(c.useState)(d),r=Object(o.a)(n,2),a=r[0],i=r[1];Object(c.useEffect)((function(){var t=new Image;t.crossOrigin="anonymus",t.src=a,t.onload=function(){var n=u.a.fromPixels(t);u.a.toPixels(n,e.current).then((function(){n.dispose()}))}}),[a]);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{className:"flip",onClick:function(){var t=Math.floor(3*Math.random()),n=u.a.fromPixels(e.current),c=u.e(n,t);u.a.toPixels(c,e.current).then((function(){n.dispose(),c.dispose()}))},children:"Flip"}),Object(f.jsx)("button",{className:"changeImg",onClick:function(){var t=[d,j,h],e=Math.floor(3*Math.random());console.log(e),i(t[e])},children:"Change"}),Object(f.jsx)("canvas",{className:"image",src:a,ref:e,alt:"hordus"})]})}var O=n(5),m=n.n(O),p=n(11),v=n.p+"static/media/ImageNetLabels.5cbe4572.txt",g=Object(c.createContext)();function x(t){var e=t.children,n=Object(c.useState)(null),r=Object(o.a)(n,2),a=r[0],i=r[1];function s(){return(s=Object(p.a)(m.a.mark((function t(){var e,n,c;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(v);case 2:return e=t.sent,t.next=5,e.text();case 5:n=t.sent,c=n.split(/\r?\n/),i(c);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return a||function(){s.apply(this,arguments)}(),Object(f.jsx)(g.Provider,{value:{labels:a},children:e})}function M(t){var e=t.imgRef,n=t.canvasRef,r=t.left,a=t.top,i=t.width,s=Object(c.useContext)(g).labels,l=Object(c.useState)(null),d=Object(o.a)(l,2),j=d[0],h=d[1],b=Object(c.useState)(null),O=Object(o.a)(b,2),m=O[0],p=O[1],v=Object(c.useState)(!1),x=Object(o.a)(v,2),M=x[0],R=x[1];if(Object(c.useEffect)((function(){if(s&&a&&r&&i&&0!==i){var t=Math.floor(e.current.width/300),c=Math.floor(e.current.height/400);R(!0),u.i((function(){u.c("https://tfhub.dev/google/tfjs-model/imagenet/inception_v3/classification/3/default/1",{fromTFHub:!0}).then((function(o){var s=u.a.fromPixels(e.current),f=u.f(s,[a*c,r*t],[i*t,i*t]),l=u.b.resizeBilinear(f,[299,299],!0).div(255);u.a.toPixels(l,n.current);var d=l.reshape([1,299,299,3]),j=o.predict(d),b=u.j(j,10),O=b.indices.dataSync(),m=b.values.dataSync();R(!1),h(Array.from(O)),p(Array.from(m))}))}))}}),[s,e,i]),M)return Object(f.jsx)("h2",{children:"Loading ..."});if(!j||!m)return null;var S=j.map((function(t,e){var n=s[t],c=parseFloat(m[e]).toFixed(2)+"%",r="https://www.google.com/search?tbm=isch&q="+n;return Object(f.jsxs)("tr",{children:[Object(f.jsx)("td",{children:Object(f.jsx)("a",{href:r,target:"_blank",children:n})}),Object(f.jsx)("td",{children:c})]},e)}));return Object(f.jsxs)("table",{className:"results",children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{children:"Prediction"}),Object(f.jsx)("th",{children:"Probability"})]})}),Object(f.jsx)("tbody",{children:S})]})}function R(t){var e,n,r,a,i,s,u=t.imgRef,l=t.setLeft,d=t.setTop,j=t.setWidth,h=!1,b=Object(c.useState)(0),O=Object(o.a)(b,2),m=O[0],p=O[1],v=Object(c.useState)(0),g=Object(o.a)(v,2),x=g[0],M=g[1],R=Object(c.useState)(0),S=Object(o.a)(R,2),w=S[0],y=S[1],P=function(){var t=Math.abs(e-i),c=Math.abs(n-s);return Math.min(t,c)},C=function(t){if(e=t.clientX,n=t.clientY,h){var c=u.current.getBoundingClientRect();if(u){e>c.right&&(e=c.right),e<c.left&&(e=c.left),n>c.bottom&&(n=c.bottom),n<c.top&&(n=c.top);var o=P();h&&(e>=i&&(r=i,i+o),n>=s&&(a=s,s+o),e<i&&(r=i-o,i),n<s&&(a=s-o,s),p(r),M(a),y(o))}}},L=function(){(function(){var t=u.current.getBoundingClientRect();return!(e<t.left||e>t.right||n<t.top||n>t.bottom)})()&&(i=e,s=n,h=!0)},E=function(){if(h){h=!1;var t=u.current.getBoundingClientRect(),e=P();l(Math.floor(r-t.left)),d(Math.floor(a-t.top)),j(Math.floor(e))}};return Object(c.useEffect)((function(){document.addEventListener("mousedown",L),document.addEventListener("touchstart",L),document.addEventListener("mouseup",E),document.addEventListener("touchend",E),document.addEventListener("mousemove",C),document.addEventListener("touchmove",C)}),[u]),Object(f.jsx)("div",{className:"rect",style:{top:x,left:m,width:w,height:w}})}function S(){document.title="carpet";var t=Object(c.useRef)(null),e=Object(c.useRef)(null),n=Object(c.useState)(0),r=Object(o.a)(n,2),a=r[0],i=r[1],s=Object(c.useState)(0),u=Object(o.a)(s,2),d=u[0],j=u[1],h=Object(c.useState)(0),O=Object(o.a)(h,2),m=O[0],p=O[1];return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(b,{imgRef:t}),Object(f.jsx)(l,{canvasRef:e}),Object(f.jsx)(M,{imgRef:t,canvasRef:e,left:a,top:d,width:m}),Object(f.jsx)(R,{imgRef:t,setLeft:i,setTop:j,setWidth:p,top:d,left:a,width:m})]})}var w=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,288)).then((function(e){var n=e.getCLS,c=e.getFID,r=e.getFCP,a=e.getLCP,i=e.getTTFB;n(t),c(t),r(t),a(t),i(t)}))};i.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(x,{children:Object(f.jsx)(S,{})})}),document.getElementById("root")),w()}},[[287,1,2]]]);
//# sourceMappingURL=main.feca835a.chunk.js.map